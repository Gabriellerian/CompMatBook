# 《计算材料学 -- 从算法原理到代码实现》
## 单斌 陈征征 陈蓉 编著
## 华中科技大学出版社 2023
<img src="https://github.com/stanfordbshan/CompMatBook/blob/main/cover.png?raw=true" width="200"/>


# 第一章 数学基础    
### 1.1 矩阵运算 
### 1.1.1 行列式 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
### 1.1.2 矩阵的本征值问题 . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
### 1.1.3 矩阵分解 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
### 1.1.4 幺正变换 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
### 1.2 群论基础 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
### 1.2.1 群的定义 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
### 1.2.2 子群、陪集、正规子群与商群 . . . . . . . . . . . . . . . . . . . . . 14
### 1.2.3 直积群 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
### 1.2.4 群的矩阵表示 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
### 1.2.5 三维转动反演群 O(3) . . . . . . . . . . . . . . . . . . . . . . . . . . 15
### 1.3 最优化方法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
### 1.3.1 最速下降法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
### 1.3.2 共轭梯度法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
### 1.3.3 牛顿法与拟牛顿法 . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
### 1.3.4 一维搜索 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
### 1.3.5 单纯形法 (simplex) . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
### 1.3.6 最小二乘法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
### 1.3.7 拉格朗日乘子 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
### 1.4 矢量正交化 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
### 1.4.1 施密特正交化 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
### 1.4.2 正交多项式 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
### 1.5 积分方法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
### 1.5.1 矩形积分法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
### 1.5.2 梯形积分法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60
### 1.5.3 辛普森积分法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
### 1.5.4 高斯积分法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63
### 1.5.5 蒙特卡罗积分方法 (Monte Carlo Method) . . . . . . . . . . . . . . 67
### 1.6 习 题 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69

# 第二章 量子力学和固体物理基础 71
## 2.1 量子力学 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71
### 2.1.1 量子力学简介 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71
### 2.1.2 薛定谔方程 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73
### 2.1.3 波函数的几率诠释 . . . . . . . . . . . . . . . . . . . . . . . . . . . 75
### 2.1.4 力学量算符和表象变换 . . . . . . . . . . . . . . . . . . . . . . . . . 77
### 2.1.5 一维方势阱 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82
### 2.1.6 方势垒的隧穿 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84
### 2.1.7 WKB 方法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87
### 2.1.8 传递矩阵法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90
### 2.1.9 氢原子 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93
### 2.1.10 变分法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100
## 2.2 晶体对称性 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103
### 2.2.1 晶体结构和点群 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103
### 2.2.2 常见晶体结构和晶面 . . . . . . . . . . . . . . . . . . . . . . . . . . 117
### 2.2.3 结构缺陷 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120
## 2.3 晶体的力学性质 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124
### 2.3.1 状态方程 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125
### 2.3.2 应变与应力 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126
### 2.3.3 弹性常数 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127
## 2.4 固体能带论 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 130
### 2.4.1 周期边界、倒空间与 Bloch 定理 . . . . . . . . . . . . . . . . . . . 131
### 2.4.2 空晶格模型与第一布里渊区 . . . . . . . . . . . . . . . . . . . . . . 135
### 2.4.3 近自由电子近似与能带间隙 . . . . . . . . . . . . . . . . . . . . . . 139
### 2.4.4 晶体能带结构 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142
### 2.4.5 介电函数 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143
## 2.5 晶格振动与声子谱 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147
## 2.6 习 题 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 152

# 第三章 第一性原理的微观计算模拟 153
## 3.1 分子轨道理论 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153
### 3.1.1 波恩-奥本海默近似（Born-Oppenheimer approximation） . . . . . 153
### 3.1.2 平均场（Mean Field）的概念 . . . . . . . . . . . . . . . . . . . . . 156
### 3.1.3 电子的空间轨道与自旋轨道 . . . . . . . . . . . . . . . . . . . . . . 157
### 3.1.4 Hartree-Fock 方法 . . . . . . . . . . . . . . . . . . . . . . . . . . . 158
### 3.1.5 HF 近似下的单电子自洽方程 . . . . . . . . . . . . . . . . . . . . . 160
### 3.1.6 Hartree-Fock 单电子波函数的讨论 . . . . . . . . . . . . . . . . . . 165
### 3.1.7 闭壳层体系中的 Hartree-Fock 方程 . . . . . . . . . . . . . . . . . . 168
### 3.1.8 开壳层体系中的 Hartree-Fock 方程 . . . . . . . . . . . . . . . . . . 170
### 3.1.9 Hartree-Fock 方程的矩阵表达 . . . . . . . . . . . . . . . . . . . . . 171
### 3.1.10 Koopmans 定理 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 173
### 3.1.11 均匀电子气模型 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 173
### 3.1.12 Hartree-Fock 方程的数值求解和基组选取 . . . . . . . . . . . . . . 178
### 3.1.13 Xα 方法和超越 HF 近似 . . . . . . . . . . . . . . . . . . . . . . . . 186
## 3.2 密度泛函理论 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 188
### 3.2.1 托马斯-费米-狄拉克近似 . . . . . . . . . . . . . . . . . . . . . . . . 189
### 3.2.2 Hohenberg-Kohn 定理 . . . . . . . . . . . . . . . . . . . . . . . . . 191
### 3.2.3 Kohn-Sham 方程 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 192
### 3.2.4 交换关联能概述 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 194
### 3.2.5 局域密度近似 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195
### 3.2.6 广义梯度近似 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 198
### 3.2.7 混合泛函 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 201
### 3.2.8 强关联与 LDA+U 方法 . . . . . . . . . . . . . . . . . . . . . . . . 202
## 3.3 赝势 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 204
### 3.3.1 正交化平面波 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 204
### 3.3.2 模守恒赝势 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 206
### 3.3.3 赝势的分部形式 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 209
### 3.3.4 超软赝势 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 212
## 3.4 平面波赝势方法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 215
### 3.4.1 布里渊区积分——特殊 k 点 . . . . . . . . . . . . . . . . . . . . . . 215
### 3.4.2 布里渊区积分——四面体法 . . . . . . . . . . . . . . . . . . . . . . 223
### 3.4.3 平面波-赝势框架下体系的总能 . . . . . . . . . . . . . . . . . . . . 233
### 3.4.4 自洽场计算的实现 . . . . . . . . . . . . . . . . . . . . . . . . . . . 247
### 3.4.5 利用共轭梯度法求解广义本征值 . . . . . . . . . . . . . . . . . . . . 249
### 3.4.6 迭代对角化方法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 253
### 3.4.7 Hellmann-Feynman 力 . . . . . . . . . . . . . . . . . . . . . . . . . 259
## 3.5 缀加平面波 (APW) 方法及其线性化 . . . . . . . . . . . . . . . . . . . . . 261
### 3.5.1 APW 方法的理论基础及公式推导 . . . . . . . . . . . . . . . . . . . 261
### 3.5.2 APW 方法的线性化处理 . . . . . . . . . . . . . . . . . . . . . . . . 267
### 3.5.3 关于势函数的讨论 . . . . . . . . . . . . . . . . . . . . . . . . . . . 270
## 3.6 过渡态 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 271
### 3.6.1 拖曳法与 NEB 方法 . . . . . . . . . . . . . . . . . . . . . . . . . . 271
### 3.6.2 Dimer 方法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 274
## 3.7 电子激发谱与准粒子近似 . . . . . . . . . . . . . . . . . . . . . . . . . . . 278
### 3.7.1 基本图像 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 278
### 3.7.2 格林函数理论与 Dyson 方程 . . . . . . . . . . . . . . . . . . . . . . 278
### 3.7.3 GW 方法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 280
### 3.7.4 Bethe-Salpeter 方程 . . . . . . . . . . . . . . . . . . . . . . . . . . 286
## 3.8 应用实例 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 288
### 3.8.1 缺陷形成能 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 288
### 3.8.2 表面能 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 291
### 3.8.3 表面巨势 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 291
### 3.8.4 集团展开与二元合金相图 . . . . . . . . . . . . . . . . . . . . . . . 294
## 3.9 习 题 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 295

# 第四章 VASP 计算模拟实例 297
## 4.1 VASP 程序介绍 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 297
## 4.2 辅助建模软件 Atomsk . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 298
## 4.3 后处理程序 VASPKIT . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 299
## 4.4 小分子气体能量计算 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 299
### 4.4.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 300
### 4.4.2 输出文件与结果分析 . . . . . . . . . . . . . . . . . . . . . . . . . . 303
## 4.5 C2H5OH 的振动模式与频率计算 . . . . . . . . . . . . . . . . . . . . . . . . 305
### 4.5.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 306
### 4.5.2 振动频率的提取和模式分析 . . . . . . . . . . . . . . . . . . . . . . 308
## 4.6 材料平衡晶格常数计算 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 309
### 4.6.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 310
### 4.6.2 Birch-Murnaghan 方程拟合 . . . . . . . . . . . . . . . . . . . . . . 312
## 4.7 堆垛层错能的计算 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 314
### 4.7.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 315
### 4.7.2 广义堆垛层错能曲线 . . . . . . . . . . . . . . . . . . . . . . . . . . 317
## 4.8 多元合金的弹性性能计算 . . . . . . . . . . . . . . . . . . . . . . . . . . . 317
### 4.8.1 各类弹性常数计算方法 . . . . . . . . . . . . . . . . . . . . . . . . . 318
### 4.8.2 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 319
### 4.8.3 弹性常数矩阵的分析讨论 . . . . . . . . . . . . . . . . . . . . . . . 321
## 4.9 空位形成能和间隙能计算 . . . . . . . . . . . . . . . . . . . . . . . . . . . 323
### 4.9.1 空位形成能的定义 . . . . . . . . . . . . . . . . . . . . . . . . . . . 323
### 4.9.2 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 324
### 4.9.3 空位形成能和间隙能结果分析与讨论 . . . . . . . . . . . . . . . . . 327
## 4.10 晶体 Si 的能带结构计算 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 327
### 4.10.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 329
### 4.10.2 能带图的绘制 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 332
## 4.11 基于 HSE06 的态密度与能带计算 . . . . . . . . . . . . . . . . . . . . . . . 332
### 4.11.1 能带图的绘制 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 333
### 4.11.2 DOS 图的绘制 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 334
## 4.12 表面能的计算 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 336
### 4.12.1 构建表面基本流程 . . . . . . . . . . . . . . . . . . . . . . . . . . . 336
### 4.12.2 表面能计算 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 337
### 4.12.3 伍尔夫结构定理 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 341
### 4.12.4 关于表面能的讨论 . . . . . . . . . . . . . . . . . . . . . . . . . . . 341
## 4.13 缺陷石墨烯的 STM 图像计算模拟 . . . . . . . . . . . . . . . . . . . . . . . 342
### 4.13.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 343
### 4.13.2 STM 图像的获取与绘制 . . . . . . . . . . . . . . . . . . . . . . . . 345
## 4.14 Pt 表面简单物种的吸附能计算 . . . . . . . . . . . . . . . . . . . . . . . . 346
### 4.14.1 Pt(111) 表面简单物种的吸附行为 . . . . . . . . . . . . . . . . . . . 347
### 4.14.2 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 348
### 4.14.3 吸附构型分析与吸附能提取 . . . . . . . . . . . . . . . . . . . . . . 349
### 4.14.4 吸附能的零点能校正 . . . . . . . . . . . . . . . . . . . . . . . . . . 350
## 4.15 Pt(111) 表面羟基解离的过渡态搜索 . . . . . . . . . . . . . . . . . . . . . 352
### 4.15.1 过渡态方法简介 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 352
### 4.15.2 Pt(111) 表面 OH 基团的解离势垒计算 . . . . . . . . . . . . . . . . 353
### 4.15.3 小结与展望 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 356
## 4.16 Pt 表面的 ORR 催化路径 . . . . . . . . . . . . . . . . . . . . . . . . . . . 356
### 4.16.1 计算氢电极（CHE）模型 . . . . . . . . . . . . . . . . . . . . . . . 357
### 4.16.2 基于 CHE 模型的氧还原反应（ORR） . . . . . . . . . . . . . . . . 358
### 4.16.3 基本参数与主要输入文件 . . . . . . . . . . . . . . . . . . . . . . . 360
### 4.16.4 小结与分析 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 361
## 4.17 习 题 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 363

# 第五章 紧束缚方法 365
## 5.1 建立 Hamiltonian 矩阵 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 365
### 5.1.1 双原子分子 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 365
### 5.1.2 原子轨道线性组合方法 . . . . . . . . . . . . . . . . . . . . . . . . . 366
### 5.1.3 Slater-Koster 双中心近似 . . . . . . . . . . . . . . . . . . . . . . . 367
### 5.1.4 哈密顿矩阵元的普遍表达式 . . . . . . . . . . . . . . . . . . . . . . 373
### 5.1.5 对自旋极化的处理 . . . . . . . . . . . . . . . . . . . . . . . . . . . 380
### 5.1.6 光吸收谱 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 381
## 5.2 体系总能与计算原子受力 . . . . . . . . . . . . . . . . . . . . . . . . . . . 382
## 5.3 自洽紧束缚方法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 383
### 5.3.1 Harris-Foulkes 非自洽泛函 . . . . . . . . . . . . . . . . . . . . . . . 384
### 5.3.2 电荷自洽紧束缚方法 . . . . . . . . . . . . . . . . . . . . . . . . . . 385
## 5.4 应用实例 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 387
### 5.4.1 闪锌矿的能带结构 . . . . . . . . . . . . . . . . . . . . . . . . . . . 388
### 5.4.2 石墨烯和碳纳米管的能带结构 . . . . . . . . . . . . . . . . . . . . . 389
## 5.5 习 题 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 392

# 第六章 分子动力学方法 393
## 6.1 简介 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 393
### 6.1.1 分子动力学基本步骤 . . . . . . . . . . . . . . . . . . . . . . . . . . 394
### 6.1.2 系综平均与时间平均 . . . . . . . . . . . . . . . . . . . . . . . . . . 395
### 6.1.3 周期性边界条件 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 396
### 6.1.4 近邻列表算法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 396
## 6.2 原子间相互作用势 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 397
### 6.2.1 对势 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 398
### 6.2.2 晶格反演势 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 400
### 6.2.3 嵌入原子势（EAM） . . . . . . . . . . . . . . . . . . . . . . . . . 402
### 6.2.4 改良型嵌入原子势（MEAM） . . . . . . . . . . . . . . . . . . . . 411
### 6.2.5 机器学习势 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 412
## 6.3 微正则系综分子动力学 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 418
### 6.3.1 前向欧拉算法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 418
### 6.3.2 Verlet 算法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 420
### 6.3.3 速度 Verlet 算法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 425
### 6.3.4 蛙跳算法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 427
### 6.3.5 预测-校正算法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 428
## 6.4 正则系综 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 432
### 6.4.1 热浴和正则系综 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 432
### 6.4.2 NPT 系综 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 445
## 6.5 第一原理分子动力学 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 447
### 6.5.1 波恩-奥本海默分子动力学 . . . . . . . . . . . . . . . . . . . . . . . 447
### 6.5.2 Car-Parrinello 分子动力学 . . . . . . . . . . . . . . . . . . . . . . . 448
## 6.6 分子动力学的应用 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 453
## 6.7 习题 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 455

# 第七章 LAMMPS 分子动力学实例 457
## 7.1 LAMMPS 程序介绍 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 457
## 7.2 可视化程序 OVITO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 459
## 7.3 惰性气体的扩散运动与平衡速率分布 . . . . . . . . . . . . . . . . . . . . . 459
### 7.3.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 460
### 7.3.2 气体扩散与平衡的讨论 . . . . . . . . . . . . . . . . . . . . . . . . . 463
## 7.4 气体分子的布朗运动 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 466
### 7.4.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 466
### 7.4.2 布朗运动与温度的讨论 . . . . . . . . . . . . . . . . . . . . . . . . . 468
## 7.5 大质量粒子的二维布朗运动 . . . . . . . . . . . . . . . . . . . . . . . . . . 469
### 7.5.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 469
### 7.5.2 大质量粒子的运动特性讨论 . . . . . . . . . . . . . . . . . . . . . . 471
## 7.6 材料的热膨胀系数计算 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 472
### 7.6.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 472
### 7.6.2 线性膨胀系数计算 . . . . . . . . . . . . . . . . . . . . . . . . . . . 474
## 7.7 体积热容的计算 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 474
### 7.7.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 475
### 7.7.2 热容的线性拟合确定 . . . . . . . . . . . . . . . . . . . . . . . . . . 476
## 7.8 Cu 的声子谱计算 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 477
### 7.8.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 477
### 7.8.2 声子谱特性讨论 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 480
## 7.9 Ni 裂纹扩展机理计算 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 481
### 7.9.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 481
### 7.9.2 应力应变与微结构演化 . . . . . . . . . . . . . . . . . . . . . . . . . 484
## 7.10 LiS 锂硫电池体积膨胀的模拟 . . . . . . . . . . . . . . . . . . . . . . . . . 485
### 7.10.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 487
### 7.10.2 Li 嵌入与体积膨胀的讨论 . . . . . . . . . . . . . . . . . . . . . . . 490
## 7.11 体相 Pt 的熔点与径向分布函数计算 . . . . . . . . . . . . . . . . . . . . . 490
### 7.11.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 492
### 7.11.2 MSD 与熔点关系的讨论 . . . . . . . . . . . . . . . . . . . . . . . . 494
## 7.12 Pt 纳米颗粒的熔点与表面熔化 . . . . . . . . . . . . . . . . . . . . . . . . 496
### 7.12.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 496
### 7.12.2 熔点与尺寸的定量讨论 . . . . . . . . . . . . . . . . . . . . . . . . . 499
### 7.12.3 表面熔化现象讨论 . . . . . . . . . . . . . . . . . . . . . . . . . . . 500
## 7.13 Pt 纳米颗粒的烧结 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 502
### 7.13.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 502
### 7.13.2 烧结过程可视化与分析 . . . . . . . . . . . . . . . . . . . . . . . . . 505
## 7.14 氢原子在 BCC-铁中的扩散 . . . . . . . . . . . . . . . . . . . . . . . . . . 507
### 7.14.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 507
### 7.14.2 均方位移与扩散稀疏的计算 . . . . . . . . . . . . . . . . . . . . . . 510
## 7.15 Ni 纳米线的屈服机制 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 511
### 7.15.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 512
### 7.15.2 应力应变曲线与微观结构演变 . . . . . . . . . . . . . . . . . . . . . 515
### 7.16 SiGe 纳米线的热导率计算 . . . . . . . . . . . . . . . . . . . . . . . . . . . 518
### 7.16.1 SiGe 纳米线的建模 . . . . . . . . . . . . . . . . . . . . . . . . . . . 518
### 7.16.2 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 519
### 7.16.3 导热率计算与讨论 . . . . . . . . . . . . . . . . . . . . . . . . . . . 521
## 7.17 多晶四元合金的切削分子动力学模拟 . . . . . . . . . . . . . . . . . . . . . 522
### 7.17.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 522
### 7.17.2 切削与多晶损伤的讨论 . . . . . . . . . . . . . . . . . . . . . . . . . 527
## 7.18 Si 表面的薄膜沉积 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 529
### 7.18.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 530
### 7.18.2 沉积形貌与表面粗糙度的讨论 . . . . . . . . . . . . . . . . . . . . . 533
## 7.19 Hybrid 势模拟石墨烯对金属纳米线的卷绕过程 . . . . . . . . . . . . . . . 534
### 7.19.1 关键参数与输入脚本 . . . . . . . . . . . . . . . . . . . . . . . . . . 535
### 7.19.2 卷绕的尺寸效应讨论 . . . . . . . . . . . . . . . . . . . . . . . . . . 536
## 7.20 习 题 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 538

# 第八章 蒙特卡罗方法 541
## 8.1 蒙特卡罗方法基本原理 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 541
### 8.1.1 投点法计算图形面积 . . . . . . . . . . . . . . . . . . . . . . . . . . 541
## 8.2 计算函数积分与采样策略 . . . . . . . . . . . . . . . . . . . . . . . . . . . 543
### 8.2.1 简单采样 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 544
### 8.2.2 重要性采样 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 545
### 8.2.3 Metropolis 采样 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 548
## 8.3 几种重要的算法与模型 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 549
### 8.3.1 NVT 正则系综的 MC 算法 . . . . . . . . . . . . . . . . . . . . . . 549
### 8.3.2 NPT 正则系综的 MC 算法 . . . . . . . . . . . . . . . . . . . . . . 551
### 8.3.3 巨正则系综的 MC 算法 . . . . . . . . . . . . . . . . . . . . . . . . 553
### 8.3.4 Ising 模型 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 556
### 8.3.5 格子气模型 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 557
### 8.3.6 Potts 模型 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 557
### 8.3.7 XY 模型 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 558
## 8.4 Gibbs 系综 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 558
### 8.4.1 随机事件及其接受几率 . . . . . . . . . . . . . . . . . . . . . . . . . 559
### 8.4.2 GEMC 算法实现 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 561
## 8.5 统计力学中的应用 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 562
### 8.5.1 随机行走 (random walk) . . . . . . . . . . . . . . . . . . . . . . . . 562
### 8.5.2 利用 Ising 模型观察铁磁-顺磁相变 . . . . . . . . . . . . . . . . . . 563
### 8.5.3 逾渗问题 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 564
## 8.6 动力学蒙特卡罗方法 (KMC) . . . . . . . . . . . . . . . . . . . . . . . . . . 567
### 8.6.1 KMC 方法的基本原理 . . . . . . . . . . . . . . . . . . . . . . . . . 567
### 8.6.2 指数分布与 KMC 方法的时间步长 . . . . . . . . . . . . . . . . . . 568
### 8.6.3 计算跃迁速率 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 570
### 8.6.4 KMC 几种不同的实现算法 . . . . . . . . . . . . . . . . . . . . . . 572
### 8.6.5 低势垒问题与小概率事件 . . . . . . . . . . . . . . . . . . . . . . . 575
### 8.6.6 实体动力学蒙特卡洛方法 . . . . . . . . . . . . . . . . . . . . . . . 576
### 8.6.7 KMC 的若干进展 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 577
## 8.7 KMC 的应用 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 580
### 8.7.1 表面迁移 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 580
### 8.7.2 晶体生长 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 583
### 8.7.3 模拟程序升温脱附过程 . . . . . . . . . . . . . . . . . . . . . . . . . 586
## 8.8 习 题 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 588

# 第九章 附录 589
## 9.1 角动量算符在球坐标中的表达式 . . . . . . . . . . . . . . . . . . . . . . . . 589
## 9.2 拉普拉斯算符在球坐标中的表达式 . . . . . . . . . . . . . . . . . . . . . . 592
## 9.3 勒让德多项式、球谐函数与角动量耦合 . . . . . . . . . . . . . . . . . . . . 594
## 9.4 三次样条 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 599
## 9.5 傅里叶变换 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 601
### 9.5.1 基本概念 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 601
### 9.5.2 离散傅里叶变换 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 603
### 9.5.3 快速傅里叶变换 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 604
## 9.6 结构分析 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 610
### 9.6.1 辨别 BCC、FCC 以及 HCP 结构 . . . . . . . . . . . . . . . . . . . 610
### 9.6.2 中心对称参数 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 613
### 9.6.3 Voronoi 算法构造多晶体系 . . . . . . . . . . . . . . . . . . . . . . 615
## 9.7 NEB 常用的优化算法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 616
### 9.7.1 Quick-Min 算法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 616
### 9.7.2 FIRE 算法 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 617
## 9.8 Pulay 电荷更新 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 618
## 9.9 最近邻原子的确定 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 619